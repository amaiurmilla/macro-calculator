function calculateMacros({sex, age, height, weight, activity, goal, system, ratios}) { if (system === 'imperial') { height *= 2.54; weight *= 0.453592; } let tmb; if (sex === 'male') { tmb = 10 * weight + 6.25 * height - 5 * age + 5; } else { tmb = 10 * weight + 6.25 * height - 5 * age - 161; } const maintenanceCalories = tmb * activity; let finalCalories; if (goal === 'lose') { finalCalories = maintenanceCalories - 500; } else if (goal === 'gain') { finalCalories = maintenanceCalories + 300; } else { finalCalories = maintenanceCalories; } let proteinGrams, fatGrams, carbsGrams; let proteinCalories, fatCalories, carbsCalories; if (ratios) { proteinCalories = finalCalories * (ratios.protein / 100); fatCalories = finalCalories * (ratios.fat / 100); carbsCalories = finalCalories * (ratios.carbs / 100); proteinGrams = proteinCalories / 4; fatGrams = fatCalories / 9; carbsGrams = carbsCalories / 4; } else { proteinGrams = weight * 2.2; fatGrams = weight * 1; proteinCalories = proteinGrams * 4; fatCalories = fatGrams * 9; carbsCalories = finalCalories - (proteinCalories + fatCalories); carbsGrams = carbsCalories / 4; } const total = proteinCalories + fatCalories + carbsCalories; const pPct = (proteinCalories / total) * 100; const fPct = (fatCalories / total) * 100; const cPct = (carbsCalories / total) * 100; return { calories: finalCalories, proteinGrams, fatGrams, carbsGrams, proteinPercent: pPct, fatPercent: fPct, carbsPercent: cPct }; } if (typeof module !== 'undefined' && module.exports) { module.exports = calculateMacros; } else { window.calculateMacros = calculateMacros; } 
